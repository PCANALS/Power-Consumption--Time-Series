data@itemInfo$brand[grep(pattern = "^Samsung", x = data@itemInfo$brand)] <- "Samsung"
data@itemInfo$brand[grep(pattern = "^Logit", x = data@itemInfo$brand)] <- "Logitech"
data@itemInfo$brand[grep(pattern = "^Microsoft", x = data@itemInfo$brand)] <- "Microsoft"
data@itemInfo$brand[grep(pattern = "^Rii", x = data@itemInfo$brand)] <- "Rii"
data@itemInfo$brand[grep(pattern = "^Alienware", x = data@itemInfo$brand)] <- "Alienware"
data@itemInfo$brand[data@itemInfo$brand %ni% c("Apple", "LG", "Acer", "HP", "Asus", "Dell", "Lenovo", "Cyberpower",
"Samsung", "Logitech", "Microsoft", "Rii", "Alienware")] <- "Others"
data@itemInfo$brand <- as.factor(data@itemInfo$brand)
###########################################################################################
########################### CREACION DE CATE DENTRO DE ITEMINFO ###########################
###########################################################################################
data@itemInfo$cate = data@itemInfo$labels
#Laptops# añadiendo las diferentes palabras clave
data@itemInfo$cate[grep(pattern = "Laptop|MacBook|Aspire|Chromebook", x = data@itemInfo$cate)] <- "Laptops"
#Desktop# # utilizando un vector por la palabra Desktop en diferentes categorias#
desks<-c("Lenovo Desktop Computer","HP Desktop","iMac","ASUS Desktop","Dell Desktop",
"Intel Desktop","Acer Desktop","CYBERPOWER Gamer Desktop","Dell 2 Desktop")
data@itemInfo$cate[grep(paste(pattern = desks, collapse="|"), x = data@itemInfo$cate)] <- "Desktops"
#Monitors# Todos los monitors finalizan en $
data@itemInfo$cate[grep(pattern = "Monitor$", x = data@itemInfo$cate)] <- "Monitors"
#Computer Mice# vector por la diversidad
mouse<- c("3-Button Mouse","Logitech Wireless Mouse","Microsoft Basic Optical Mouse",
"Logitech 3-button Mouse","Redragon Gaming Mouse","HP Wireless Mouse","Generic Black 3-Button",
"Wireless Portable Mouse","Gaming Mouse Professional","Slim Wireless Mouse")
data@itemInfo$cate[grep(paste(pattern = mouse, collapse="|"), x = data@itemInfo$cate)] <- "Computer Mice"
#Keyboard# acabado en Keyboard$
data@itemInfo$cate[grep(pattern = "Keyboard$", x = data@itemInfo$cate)] <- "Keyboard"
#Mouse and Keyboard Combo#
data@itemInfo$cate[grep(pattern = "Combo", x = data@itemInfo$cate)] <- "Mouse and Keyboard Combo"
data@itemInfo$cate[grep(pattern = "Keyboard and Mouse", x = data@itemInfo$cate)] <- "Mouse and Keyboard Combo"
data@itemInfo$cate[grep(pattern = "Keyboard & Mouse", x = data@itemInfo$cate)] <- "Mouse and Keyboard Combo"
#Computer Headphones# #mezcla de generico y especifico por no tener key words#
data@itemInfo$cate[grep(pattern = "Headset", x = data@itemInfo$cate)] <- "Computer Headphones"
data@itemInfo$cate[grep(pattern = "On-Ear", x = data@itemInfo$cate)] <- "Computer Headphones"
data@itemInfo$cate[grep(pattern = "Ailihen", x = data@itemInfo$cate)] <-"Computer Headphones"
data@itemInfo$cate[grep(pattern = "Koss", x = data@itemInfo$cate)] <- "Computer Headphones"
data@itemInfo$cate[grep(pattern = "Kensington Headphones", x = data@itemInfo$cate)] <- "Computer Headphones"
#Active Headphones# #especifico por no existir key words#
data@itemInfo$cate[grep(pattern = "Earpods", x = data@itemInfo$cate)] <- "Active Headphones"
data@itemInfo$cate[grep(pattern = "Bluetooth Headphone", x = data@itemInfo$cate)] <- "Active Headphones"
data@itemInfo$cate[grep(pattern = "Beats", x = data@itemInfo$cate)] <- "Active Headphones"
data@itemInfo$cate[grep(pattern = "In-Ear", x = data@itemInfo$cate)] <- "Active Headphones"
data@itemInfo$cate[grep(pattern = "Earhook", x = data@itemInfo$cate)] <- "Active Headphones"
#Computer Cords# #key word#
data@itemInfo$cate[grep(pattern = "Cable", x = data@itemInfo$cate)] <- "Computer Cords"
data@itemInfo$cate[grep(pattern = "HDMI", x = data@itemInfo$cate)] <- "Computer Cords"
#Accessories#
data@itemInfo$cate[grep(pattern = "Mouse Pad", x = data@itemInfo$cate)] <- "Accesories"
data@itemInfo$cate[grep(pattern = "Computer Game", x = data@itemInfo$cate)] <- "Accesories"
data@itemInfo$cate[grep(pattern = "Home and Student", x = data@itemInfo$cate)] <- "Accesories"
#Speakers# Mezcla key word y especifico#
data@itemInfo$cate[grep(pattern = "Speaker", x = data@itemInfo$cate)] <- "Speakers"
data@itemInfo$cate[grep(pattern = "Sonos", x = data@itemInfo$cate)] <- "Speakers"
data@itemInfo$cate[grep(pattern = "Acoustics", x = data@itemInfo$cate)] <- "Speakers"
data@itemInfo$cate[grep(pattern = "DOSS Touch Wireless Bluetooth", x = data@itemInfo$cate)] <- "Speakers"
#Printers # con vector para evitar confusion con Printer Ink#
printers<- c("Epson Printer","HP Wireless Printer","Canon Office Printer",
"Brother Printer","DYMO Label Manker")
data@itemInfo$cate[grep(paste(pattern = printers, collapse="|"), x = data@itemInfo$cate)] <- "Printers"
#Printer Ink# key words genericas#
data@itemInfo$cate[grep(pattern = "Ink", x = data@itemInfo$cate)] <- "Printer Ink"
data@itemInfo$cate[grep(pattern = "Toner", x = data@itemInfo$cate)] <- "Printer Ink"
data@itemInfo$cate[grep(pattern = "Tape", x = data@itemInfo$cate)] <- "Printer Ink"
#Computer Stands# key words genericas#
data@itemInfo$cate[grep(pattern = "Stand", x = data@itemInfo$cate)] <- "Computer Stands"
data@itemInfo$cate[grep(pattern = "Mount", x = data@itemInfo$cate)] <- "Computer Stands"
#Computer Tablets# especifico por key words dentro de otras palabras
data@itemInfo$cate[grep(pattern = "iPad", x = data@itemInfo$cate)] <- "Computer Tablets"
data@itemInfo$cate[grep(pattern = "Kindle", x = data@itemInfo$cate)] <- "Computer Tablets"
data@itemInfo$cate[grep(pattern = "Fire HD Tablet", x = data@itemInfo$cate)] <- "Computer Tablets"
data@itemInfo$cate[grep(pattern = "Samsung Galaxy Tab", x = data@itemInfo$cate)] <- "Computer Tablets"
#External Hardrives# mix
data@itemInfo$cate[grep(pattern = "External", x = data@itemInfo$cate)] <- "External Hardrives"
data@itemInfo$cate[grep(pattern = "5TB Desktop Hard Drive", x = data@itemInfo$cate)] <- "External Hardrives"
#Smart Home Devices# mix
data@itemInfo$cate[grep(pattern = "TV", x = data@itemInfo$cate)] <- "Smart Home Devices"
data@itemInfo$cate[grep(pattern = "Google Home", x = data@itemInfo$cate)] <- "Smart Home Devices"
data@itemInfo$cate[grep(pattern = "Smart Light Bulb", x = data@itemInfo$cate)] <- "Smart Home Devices"
data@itemInfo$cate[grep(pattern = "Roku Express", x = data@itemInfo$cate)] <- "Smart Home Devices"
data@itemInfo$cate <- as.factor(data@itemInfo$cate)
itemFrequencyPlot(data,
topN = 10, #Hay que indicarle un top o no puede plotear#
type = "absolute",
names = T,
ylab = "Volume",
main = "Top 10 Products Electronidex",
col = "light blue"
)
black <- within(black,
Product.Type <- factor(Product.Type,
levels=names(sort(table(Product.Type),
decreasing=TRUE))))
p <- ggplot(data=black, aes(x=Product.Type)) +
geom_bar(color = "black", fill="lightblue") +
ggtitle("Blackwell products by category") +
xlab("") +
ylab("Amoutn of products") +
theme_classic() +
theme(axis.text.x = element_text(angle=20))
p
data %>%
aggregate("cate") %>%
itemFrequencyPlot(topN = 17,
type = "absolute",
names = T,
ylab = "Volume",
xlab = "",
main = "Electronidex products by category",
col = "light blue"
)
##########################
### Generico Producto ###
##########################
rules.generic = apriori(data = data, parameter = list(support = 0.01, confidence = 0.5, minlen = 2))
inspect(head(sort(rules.generic, by="confidence"),6))
hist(size(data),
main = "Frequency of transactions",
xlab = "Quantity of products by transaction",
ylab = "Amount",
col = "light blue"
)
products<-c(data@itemInfo$labels)
rhsproducts<-products[products %ni% c("iMac", "HP Laptop")]
rules.product <- apriori(data = data,
appearance = list(rhs=rhsproducts),
parameter = list(support = 0.01,
confidence = 0.1,
minlen=2)
)
inspect(head(sort(rules.product, by="confidence"),5))
###########################
### GENERICO PARA BRAND ###
###########################
brand.cat <- arules::aggregate(x = data, by = "brand")
rules.brand <- apriori(data = brand.cat,
parameter = list(support = 0.01, confidence = 0.5, minlen =2))
inspect(head(sort(rules.brand, by="confidence"),6))
###########################
### GENERICO PARA APPLE ###
###########################
brand.cat <- arules::aggregate(x = data, by = "brand")
rules.apple <- apriori(data = brand.cat,
appearance = list(lhs= "Apple"),
parameter = list(support = 0.01, confidence = 0.3, minlen =2))
inspect(head(sort(rules.apple, by="confidence"),15))
cate.cat <- arules::aggregate(x = data, by = "cate")
categorias <- levels(data@itemInfo$cate)
rules.cat<-apriori(data = cate.cat,
parameter = list(support = 0.01, confidence = 0.8, minlen =2))
inspect(head(sort(rules.cat, by="confidence"),6))
#agregate#
rhscate <- categorias[categorias %ni% c("Desktops", "Laptops")]
rules.rhs <- apriori(data = cate.cat, appearance = list(rhs=rhscate), parameter = list(support = 0.01, confidence = 0.1, minlen=2))
inspect(head(sort(rules.rhs, by="confidence"),6))
rm(list = ls())
library(arules)
library(arulesViz)
library(dplyr)
library(ggplot2)
"%ni%" = Negate("%in%")
#
# data = read.transactions("C:/Users/David/Google Drive/Ubiqum/5_MBA/transactions.csv",
#                   format = "basket",
#                   sep = ",",
#                   rm.duplicates = T,
#                   encoding = "unknown")
#
# black = read.csv("C:/Users/David/Google Drive/Ubiqum/1_Blackwell/Regression Project/Data/existingProductAttributes.csv")
setwd("C:/Users/pilar/Documents/Ubiqum/TASK2.4/task-2-4-basket-analysis-PCANALS")
data = read.transactions("transactions.csv",
format = "basket",
sep = ",",
rm.duplicates = T,
encoding = "unknown")
black<- read.csv("existingProductAttributes.csv")
dataHigh <- data[size(data) <= 5 & size(data) > 0]
dataLow<-data[size(data)>5]
###########################################################################################
######################## CREACION DE BRAND DENTRO DE ITEMINFO ########################
###########################################################################################
data@itemInfo$brand = data@itemInfo$labels
data@itemInfo$brand[grep(pattern = "^i[A-Z]", x = data@itemInfo$brand)] <- "Apple"
data@itemInfo$brand[grep(pattern = "^Apple", x = data@itemInfo$brand)] <- "Apple"
data@itemInfo$brand[grep(pattern = "^LG", x = data@itemInfo$brand)] <- "LG"
data@itemInfo$brand[grep(pattern = "^Acer", x = data@itemInfo$brand)] <- "Acer"
data@itemInfo$brand[grep(pattern = "^HP", x = data@itemInfo$brand)] <- "HP"
data@itemInfo$brand[grep(pattern = "^ASUS", x = data@itemInfo$brand)] <- "Asus"
data@itemInfo$brand[grep(pattern = "^Dell", x = data@itemInfo$brand)] <- "Dell"
data@itemInfo$brand[grep(pattern = "^Lenovo", x = data@itemInfo$brand)] <- "Lenovo"
data@itemInfo$brand[grep(pattern = "^CYBERPOWER", x = data@itemInfo$brand)] <- "Cyberpower"
data@itemInfo$brand[grep(pattern = "^Samsung", x = data@itemInfo$brand)] <- "Samsung"
data@itemInfo$brand[grep(pattern = "^Logit", x = data@itemInfo$brand)] <- "Logitech"
data@itemInfo$brand[grep(pattern = "^Microsoft", x = data@itemInfo$brand)] <- "Microsoft"
data@itemInfo$brand[grep(pattern = "^Rii", x = data@itemInfo$brand)] <- "Rii"
data@itemInfo$brand[grep(pattern = "^Alienware", x = data@itemInfo$brand)] <- "Alienware"
data@itemInfo$brand[data@itemInfo$brand %ni% c("Apple", "LG", "Acer", "HP", "Asus", "Dell", "Lenovo", "Cyberpower",
"Samsung", "Logitech", "Microsoft", "Rii", "Alienware")] <- "Others"
data@itemInfo$brand <- as.factor(data@itemInfo$brand)
###########################################################################################
########################### CREACION DE CATE DENTRO DE ITEMINFO ###########################
###########################################################################################
data@itemInfo$cate = data@itemInfo$labels
#Laptops# añadiendo las diferentes palabras clave
data@itemInfo$cate[grep(pattern = "Laptop|MacBook|Aspire|Chromebook", x = data@itemInfo$cate)] <- "Laptops"
#Desktop# # utilizando un vector por la palabra Desktop en diferentes categorias#
desks<-c("Lenovo Desktop Computer","HP Desktop","iMac","ASUS Desktop","Dell Desktop",
"Intel Desktop","Acer Desktop","CYBERPOWER Gamer Desktop","Dell 2 Desktop")
data@itemInfo$cate[grep(paste(pattern = desks, collapse="|"), x = data@itemInfo$cate)] <- "Desktops"
#Monitors# Todos los monitors finalizan en $
data@itemInfo$cate[grep(pattern = "Monitor$", x = data@itemInfo$cate)] <- "Monitors"
#Computer Mice# vector por la diversidad
mouse<- c("3-Button Mouse","Logitech Wireless Mouse","Microsoft Basic Optical Mouse",
"Logitech 3-button Mouse","Redragon Gaming Mouse","HP Wireless Mouse","Generic Black 3-Button",
"Wireless Portable Mouse","Gaming Mouse Professional","Slim Wireless Mouse")
data@itemInfo$cate[grep(paste(pattern = mouse, collapse="|"), x = data@itemInfo$cate)] <- "Computer Mice"
#Keyboard# acabado en Keyboard$
data@itemInfo$cate[grep(pattern = "Keyboard$", x = data@itemInfo$cate)] <- "Keyboard"
#Mouse and Keyboard Combo#
data@itemInfo$cate[grep(pattern = "Combo", x = data@itemInfo$cate)] <- "Mouse and Keyboard Combo"
data@itemInfo$cate[grep(pattern = "Keyboard and Mouse", x = data@itemInfo$cate)] <- "Mouse and Keyboard Combo"
data@itemInfo$cate[grep(pattern = "Keyboard & Mouse", x = data@itemInfo$cate)] <- "Mouse and Keyboard Combo"
#Computer Headphones# #mezcla de generico y especifico por no tener key words#
data@itemInfo$cate[grep(pattern = "Headset", x = data@itemInfo$cate)] <- "Computer Headphones"
data@itemInfo$cate[grep(pattern = "On-Ear", x = data@itemInfo$cate)] <- "Computer Headphones"
data@itemInfo$cate[grep(pattern = "Ailihen", x = data@itemInfo$cate)] <-"Computer Headphones"
data@itemInfo$cate[grep(pattern = "Koss", x = data@itemInfo$cate)] <- "Computer Headphones"
data@itemInfo$cate[grep(pattern = "Kensington Headphones", x = data@itemInfo$cate)] <- "Computer Headphones"
#Active Headphones# #especifico por no existir key words#
data@itemInfo$cate[grep(pattern = "Earpods", x = data@itemInfo$cate)] <- "Active Headphones"
data@itemInfo$cate[grep(pattern = "Bluetooth Headphone", x = data@itemInfo$cate)] <- "Active Headphones"
data@itemInfo$cate[grep(pattern = "Beats", x = data@itemInfo$cate)] <- "Active Headphones"
data@itemInfo$cate[grep(pattern = "In-Ear", x = data@itemInfo$cate)] <- "Active Headphones"
data@itemInfo$cate[grep(pattern = "Earhook", x = data@itemInfo$cate)] <- "Active Headphones"
#Computer Cords# #key word#
data@itemInfo$cate[grep(pattern = "Cable", x = data@itemInfo$cate)] <- "Computer Cords"
data@itemInfo$cate[grep(pattern = "HDMI", x = data@itemInfo$cate)] <- "Computer Cords"
#Accessories#
data@itemInfo$cate[grep(pattern = "Mouse Pad", x = data@itemInfo$cate)] <- "Accesories"
data@itemInfo$cate[grep(pattern = "Computer Game", x = data@itemInfo$cate)] <- "Accesories"
data@itemInfo$cate[grep(pattern = "Home and Student", x = data@itemInfo$cate)] <- "Accesories"
#Speakers# Mezcla key word y especifico#
data@itemInfo$cate[grep(pattern = "Speaker", x = data@itemInfo$cate)] <- "Speakers"
data@itemInfo$cate[grep(pattern = "Sonos", x = data@itemInfo$cate)] <- "Speakers"
data@itemInfo$cate[grep(pattern = "Acoustics", x = data@itemInfo$cate)] <- "Speakers"
data@itemInfo$cate[grep(pattern = "DOSS Touch Wireless Bluetooth", x = data@itemInfo$cate)] <- "Speakers"
#Printers # con vector para evitar confusion con Printer Ink#
printers<- c("Epson Printer","HP Wireless Printer","Canon Office Printer",
"Brother Printer","DYMO Label Manker")
data@itemInfo$cate[grep(paste(pattern = printers, collapse="|"), x = data@itemInfo$cate)] <- "Printers"
#Printer Ink# key words genericas#
data@itemInfo$cate[grep(pattern = "Ink", x = data@itemInfo$cate)] <- "Printer Ink"
data@itemInfo$cate[grep(pattern = "Toner", x = data@itemInfo$cate)] <- "Printer Ink"
data@itemInfo$cate[grep(pattern = "Tape", x = data@itemInfo$cate)] <- "Printer Ink"
#Computer Stands# key words genericas#
data@itemInfo$cate[grep(pattern = "Stand", x = data@itemInfo$cate)] <- "Computer Stands"
data@itemInfo$cate[grep(pattern = "Mount", x = data@itemInfo$cate)] <- "Computer Stands"
#Computer Tablets# especifico por key words dentro de otras palabras
data@itemInfo$cate[grep(pattern = "iPad", x = data@itemInfo$cate)] <- "Computer Tablets"
data@itemInfo$cate[grep(pattern = "Kindle", x = data@itemInfo$cate)] <- "Computer Tablets"
data@itemInfo$cate[grep(pattern = "Fire HD Tablet", x = data@itemInfo$cate)] <- "Computer Tablets"
data@itemInfo$cate[grep(pattern = "Samsung Galaxy Tab", x = data@itemInfo$cate)] <- "Computer Tablets"
#External Hardrives# mix
data@itemInfo$cate[grep(pattern = "External", x = data@itemInfo$cate)] <- "External Hardrives"
data@itemInfo$cate[grep(pattern = "5TB Desktop Hard Drive", x = data@itemInfo$cate)] <- "External Hardrives"
#Smart Home Devices# mix
data@itemInfo$cate[grep(pattern = "TV", x = data@itemInfo$cate)] <- "Smart Home Devices"
data@itemInfo$cate[grep(pattern = "Google Home", x = data@itemInfo$cate)] <- "Smart Home Devices"
data@itemInfo$cate[grep(pattern = "Smart Light Bulb", x = data@itemInfo$cate)] <- "Smart Home Devices"
data@itemInfo$cate[grep(pattern = "Roku Express", x = data@itemInfo$cate)] <- "Smart Home Devices"
data@itemInfo$cate <- as.factor(data@itemInfo$cate)
itemFrequencyPlot(data,
topN = 10, #Hay que indicarle un top o no puede plotear#
type = "absolute",
names = T,
ylab = "Volume",
main = "Top 10 Products Electronidex",
col = "mediumturquoise"
)
black <- within(black,
Product.Type <- factor(Product.Type,
levels=names(sort(table(Product.Type),
decreasing=TRUE))))
p <- ggplot(data=black, aes(x=Product.Type)) +
geom_bar(color = "black", fill="lightblue") +
ggtitle("Blackwell products by category") +
xlab("") +
ylab("Amoutn of products") +
theme_classic() +
theme(axis.text.x = element_text(angle=20))
p
data %>%
aggregate("cate") %>%
itemFrequencyPlot(topN = 17,
type = "absolute",
names = T,
ylab = "Volume",
xlab = "",
main = "Electronidex products by Product Type",
col = "mediumturquoise"
)
##########################
### Generico Producto ###
##########################
rules.generic = apriori(data = data, parameter = list(support = 0.01, confidence = 0.5, minlen = 2))
inspect(head(sort(rules.generic, by="confidence"),6))
hist(size(data),
main = "Frequency of transactions",
xlab = "Quantity of products by transaction",
ylab = "Amount",
col = "light blue"
)
products<-c(data@itemInfo$labels)
rhsproducts<-products[products %ni% c("iMac", "HP Laptop")]
rules.product <- apriori(data = data,
appearance = list(rhs=rhsproducts),
parameter = list(support = 0.01,
confidence = 0.1,
minlen=2)
)
inspect(head(sort(rules.product, by="confidence"),5))
###########################
### GENERICO PARA BRAND ###
###########################
brand.cat <- arules::aggregate(x = data, by = "brand")
rules.brand <- apriori(data = brand.cat,
parameter = list(support = 0.01, confidence = 0.5, minlen =2))
inspect(head(sort(rules.brand, by="confidence"),6))
###########################
### GENERICO PARA APPLE ###
###########################
brand.cat <- arules::aggregate(x = data, by = "brand")
rules.apple <- apriori(data = brand.cat,
appearance = list(lhs= "Apple"),
parameter = list(support = 0.01, confidence = 0.3, minlen =2))
inspect(head(sort(rules.apple, by="confidence"),15))
cate.cat <- arules::aggregate(x = data, by = "cate")
categorias <- levels(data@itemInfo$cate)
rules.cat<-apriori(data = cate.cat,
parameter = list(support = 0.01, confidence = 0.8, minlen =2))
inspect(head(sort(rules.cat, by="confidence"),6))
#agregate#
rhscate <- categorias[categorias %ni% c("Desktops", "Laptops")]
rules.rhs <- apriori(data = cate.cat, appearance = list(rhs=rhscate), parameter = list(support = 0.01, confidence = 0.1, minlen=2))
inspect(head(sort(rules.rhs, by="confidence"),6))
source('C:/Users/pilar/Google Drive/A_DATA/UBIQUM/TASK3.1/task-3-1-define-a-data-science-process-PCANALS/POWER.R', echo=TRUE)
install.packages("rlang")
library("rlang", lib.loc="~/R/win-library/3.5")
power_new[is.na(power_new)] <- 0
source('C:/Users/pilar/Google Drive/A_DATA/UBIQUM/TASK3.1/task-3-1-define-a-data-science-process-PCANALS/POWER.R', echo=TRUE)
source('C:/Users/pilar/Google Drive/A_DATA/UBIQUM/TASK3.1/task-3-1-define-a-data-science-process-PCANALS/POWER.R', echo=TRUE)
install.packages("Rcpp")
library("Rcpp", lib.loc="~/R/win-library/3.5")
source('C:/Users/pilar/Google Drive/A_DATA/UBIQUM/TASK3.1/task-3-1-define-a-data-science-process-PCANALS/POWER.R', echo=TRUE)
install.packages("tseries")
library(tidyselect)
library(lubridate)
rm(list = ls())
Sys.setlocale(category = "LC_ALL", locale = "english")
library(lubridate)
#####includes:
#library(dplyr)
#library(ggplot2)
#library(tidyr)
tidyverse_update()
#install.packages("tidyverse")
library(tidyverse)
library(dplyr)
library(ggplot2)
library(tidyr)
source('C:/Users/pilar/Google Drive/A_DATA/UBIQUM/TASK3.1/task-3-1-define-a-data-science-process-PCANALS/POWER.R', encoding = 'UTF-8', echo=TRUE)
pwm_ts
stats.ns(pwm_ts[,3])
library("imputeTS", lib.loc="~/R/win-library/3.5")
stats.ns(pwm_ts[,3])
stats.ts(pwm_ts[,3])
statsNA(pwm_ts[,3])
statsNA(pwd_ts)
autoplot(pwm_ts_dec[,3])
#pwm_ts_log<-log(pwm_ts)
pwm_ts_dec<-decompose(pwm_ts) #additive# there are NA values in trend and random#
pwm_ts_dec
View(pwm_ts_dec)
autoplot(pwm_ts_dec[,3])
autoplot(pwm_ts_dec)
plot(pwm_ts_dec)
plot(pwm_ts_dec)
plot(pwm_ts_dec[,3])
tsoutliers(pwm_ts[,3])
tsoutliers(pwm_ts[,2])
View(pwm_ts)
View(pwd_ts)
tsoutliers(pwd_ts[,2])
plot(pwm_ts_dec[,3])
#pwm_ts_log<-log(pwm_ts)
pwm_ts3<-pwm_ts[,3]
pwm_ts_dec<-decompose(pwm_ts3) #additive# there are NA values in trend and random#
pwm_ts_dec<-decompose(pwm_ts3) #additive# there are NA values in trend and random#
pwm_ts_dec
plot(pwm_ts_dec)
pwm_ts3 %>% decompose %>% autoplot
pwm_ts3 %>% stl(s.window='periodic') %>% autoplot
?stl
pwm_ts3 %>% stl(s.window='periodic')
autoplot(pwm_ts3, series="Data") +
autolayer(trendcycle(fit), series="Trend") +
autolayer(seasadj(fit), series="Seasonally Adjusted") +
xlab("Year") + ylab("New orders index") +
ggtitle("decompose") +
scale_colour_manual(values=c("gray","blue","red"),
breaks=c("Data","Seasonally Adjusted","Trend"))
?mstl
autoplot(pwm_ts3, series="Data") +
autolayer(trendcycle(pwm_ts_dec ), series="Trend") +
autolayer(seasadj(pwm_ts_dec ), series="Seasonally Adjusted") +
xlab("Year") + ylab("New orders index") +
ggtitle("decompose") +
scale_colour_manual(values=c("gray","blue","red"),
breaks=c("Data","Seasonally Adjusted","Trend"))
pwm_fore<-HoltWinters(pwm_ts3, beta = FALSE, gamma = FALSE)
pwm_fore
View(pwm_fore)
pwm_fore$fitted
autoplot(pwm_fore)
summary(power_new$Global_active_power_Wh)
plot(pwm_fore)
pwm_ts3 %>% stl(s.window='periodic') %>% autoplot  #smoothing is effectively replaced by taking the mean.
pwm_ts3 %>% decompose %>% autoplot
pwm_fore<-HoltWinters(pwm_ts3)
autoplot(pwm_fore)
pwm_fore<-HoltWinters(pwm_ts3, gamma = FALSE)
autoplot(pwm_fore)
View(pwm_fore)
forecast(pwm_fore)
forecast(pwm_fore, h = 6)
x<-forecast(pwm_fore, h = 6)
acf(x)
acf(x$residuals)
acf(x$residuals, na.action = na.pass)
autoplot(BoxCox(pwm_ts[,3],lambda))
res <- residuals(naive(pwm_ts))
autoplot(res)
res <- residuals(naive(pwm_ts))
Box.test(x$residuals)
-BoxCox.lambda(pwm_ts)
Box.test(x$residuals, lag = 12 )
Box.test(x$residuals, lag = 24 )
acf(x$residuals, na.action = na.pass)
acf(x$residuals, na.action = na.pass)
acf(x)
x
acf(x$fitted)
acf(x$fitted, na.action = na.pass)
x$fitted
GGally::ggpairs(as.data.frame(pwm_ts[,3:8])) ###correlation with features###
GGally::ggpairs(as.data.frame(pwm_ts[,3])) ###correlation with features###
ggAcf(pwm_ts[,3], lag=48) ### pendiente arreglar la derivada####
ggAcf(pwm_ts[,3], lag=6) ### pendiente arreglar la derivada####
ggAcf(pwm_ts[,3], lag=1) ### pendiente arreglar la derivada####
ggAcf(pwm_ts[,3], lag=20) ### pendiente arreglar la derivada####
?ggAcf
pwm_fore<-HoltWinters(pwm_ts3)
plot(pwm_fore)
autoplot(pwm_fore)
x<-forecast(pwm_fore, h = 6)
acf(x$residuals, na.action = na.pass)
Box.test(x$residuals, lag = 24 )
Box.test(x$residuals, lag = 12 )
pwm_fore<-HoltWinters(pwm_ts3)
pwm_fore
pwm_fore<-HoltWinters(pwm_ts3, alpha = FALSE)
pwm_fore<-HoltWinters(pwm_ts3, beta = FALSE)
pwm_fore<-HoltWinters(pwm_ts3, gamma = FALSE)
pwm_fore
pwm_fore<-HoltWinters(pwm_ts3, alpha = FALSE)
pwm_fore<-HoltWinters(pwm_ts3, alpha = FALSE, beta = FALSE)
pwm_ts3
autoplot(pwm_ts3)
plot(pwm_ts_dec)
pwm_ts3 %>% stl(s.window='periodic') %>% autoplot  #smoothing is effectively replaced by taking the mean.
pwm_ts_dec
plot(pwm_ts_dec)
pwm_ts3_dec
pwm_ts_dec
plot(decompose(pwm_ts3-pwm_ts_dec$trend))
pwm_fore<-HoltWinters(pwm_ts3)
pwm_fore
plot(pwm_fore)
x<-forecast(pwm_fore, h = 6)
acf(x$residuals, na.action = na.pass)
hist(x$residuals)
par(nrow(3))
plot(pwm_fore)
acf(x$residuals, na.action = na.pass)
hist(x$residuals)
acf(x$residuals, na.action = na.pass)
plot(pwm_fore)
hist(x$residuals)
Box.test(x$residuals, lag = 12 )
Box.test(x$residuals, lag = 6 )
forecast.HoltWinters(pwm_fore, h=6)
forecast::forecast.HoltWinters(pwm_fore, h=6)
library("forecast", lib.loc="~/R/win-library/3.5")
forecast::forecast.HoltWinters(pwm_fore, h=6)
forecast.HoltWinters(pwm_fore, h=6)
forecast::hw(pwm_fore,h=6)
library("stats", lib.loc="C:/Program Files/R/R-3.5.1/library")
forecast.HoltWinters(pwm_fore, h=6)
forecast.HoltWinters(pwm_fore, h=6)
forecast.HoltWinters(pwm_fore, h=6)
forecast:::forecast.HoltWinters(pwm_fore,h=6)
plot(forecast:::forecast.HoltWinters(pwm_fore,h=6))
plot(forecast:::forecast.HoltWinters(pwm_fore,h=12))
